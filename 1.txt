-- Create DEPARTMENT Table
CREATE TABLE DEPARTMENT (
    Dno INTEGER NOT NULL PRIMARY KEY,
    Dname VARCHAR(50),
    Location VARCHAR(50) DEFAULT 'New Delhi'
);

-- Create EMPLOYEE Table
CREATE TABLE EMPLOYEE (
    Eno CHAR(3) NOT NULL PRIMARY KEY,
    Ename VARCHAR(50) NOT NULL,
    Job_type VARCHAR(50) NOT NULL,
    Manager CHAR(3),
    Hire_date DATE NOT NULL,
    Dno INTEGER,
    Commission DECIMAL(10,2),
    Salary DECIMAL(7,2) NOT NULL,
    FOREIGN KEY (Dno) REFERENCES DEPARTMENT(Dno),
    FOREIGN KEY (Manager) REFERENCES EMPLOYEE(Eno)
);

-- Query 1
SELECT Eno, Ename, Job_type, Hire_date FROM EMPLOYEE;

-- Query 2
SELECT DISTINCT Job_type FROM EMPLOYEE;

-- Query 3
SELECT CONCAT(Ename, ', ', Job_type) AS Employee_Job FROM EMPLOYEE;

-- Query 4
SELECT 
  CONCAT(Eno, ', ', Ename, ', ', Job_type, ', ', Manager, ', ', Hire_date, ', ', Dno, ', ', Commission, ', ', Salary) AS THE_OUTPUT 
FROM EMPLOYEE;

-- Query 5
SELECT Ename, Salary FROM EMPLOYEE WHERE Salary > 2850;

-- Query 6
SELECT Ename, Dno FROM EMPLOYEE WHERE Eno = '7900';

-- Query 7
SELECT Ename, Salary FROM EMPLOYEE WHERE Salary NOT BETWEEN 1500 AND 2850;

-- Query 8
SELECT Ename, Dno FROM EMPLOYEE 
WHERE Dno IN (10, 30) 
ORDER BY Ename;

-- Query 9
SELECT Ename, Hire_date FROM EMPLOYEE 
WHERE YEAR(Hire_date) = 1981;

-- Query 10
SELECT Ename, Job_type FROM EMPLOYEE 
WHERE Manager IS NULL;

-- Query 11
SELECT Ename, Salary, Commission FROM EMPLOYEE 
WHERE Commission IS NOT NULL;

-- Query 12
SELECT * FROM EMPLOYEE 
ORDER BY Salary DESC, Commission DESC;

-- Query 13
SELECT Ename FROM EMPLOYEE 
WHERE SUBSTRING(Ename, 3, 1) = 'A';

-- Query 14
SELECT Ename FROM EMPLOYEE 
WHERE (Ename LIKE '%R%R%' OR Ename LIKE '%A%A%') 
AND (Dno = 30 OR Manager = '7788');

-- Query 15
SELECT Ename, Salary, Commission FROM EMPLOYEE 
WHERE Commission = (Salary * 1.05) + 14;

-- Query 16
SELECT CURRENT_DATE;

-- Query 17
SELECT Ename, Dname FROM EMPLOYEE 
JOIN DEPARTMENT ON EMPLOYEE.Dno = DEPARTMENT.Dno 
WHERE Ename LIKE '%A%';

-- Query 18
SELECT Ename, TIMESTAMPDIFF(MONTH, Hire_date, CURDATE()) AS Months_Since_Hire FROM EMPLOYEE;

-- Query 19
SELECT Ename, Salary, CONCAT(Ename, ' earns ', Salary, ' monthly but wants ', 3 * Salary) AS Dream_Salary FROM EMPLOYEE;

-- Query 20
SELECT CONCAT(UCASE(LEFT(Ename, 1)), LCASE(SUBSTRING(Ename, 2))) AS Proper_Name, LENGTH(Ename) AS Name_Length 
FROM EMPLOYEE 
WHERE Ename LIKE 'J%' OR Ename LIKE 'A%' OR Ename LIKE 'M%';

-- Query 21
SELECT Ename, Hire_date, DAYNAME(Hire_date) AS Start_Day FROM EMPLOYEE;

-- Query 22
SELECT Ename, DEPARTMENT.Dname, EMPLOYEE.Dno 
FROM EMPLOYEE 
JOIN DEPARTMENT ON EMPLOYEE.Dno = DEPARTMENT.Dno;

-- Query 23
SELECT DISTINCT Job_type 
FROM EMPLOYEE 
WHERE Dno = 30;

-- Query 24
SELECT Ename, Dname 
FROM EMPLOYEE 
JOIN DEPARTMENT ON EMPLOYEE.Dno = DEPARTMENT.Dno 
WHERE Ename LIKE '%A%';

-- Query 25
SELECT Ename, Job_type, EMPLOYEE.Dno, Dname 
FROM EMPLOYEE 
JOIN DEPARTMENT ON EMPLOYEE.Dno = DEPARTMENT.Dno 
WHERE Location = 'Dallas';

-- Query 26
SELECT E1.Ename AS Employee_Name, E1.Eno AS Employee_No,
       E2.Ename AS Manager_Name, E2.Eno AS Manager_No
FROM EMPLOYEE E1
LEFT JOIN EMPLOYEE E2 ON E1.Manager = E2.Eno;

-- Query 27
SELECT Ename, Dno, Salary 
FROM EMPLOYEE 
WHERE (Dno, Salary) IN (
    SELECT Dno, Salary 
    FROM EMPLOYEE 
    WHERE Commission IS NOT NULL
);
