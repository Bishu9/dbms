-- 18. Display Name and calculate the number of months between today and the date each employee was hired.
SELECT Ename, TIMESTAMPDIFF(MONTH, Hire_date, CURDATE()) AS Months_Since_Hire FROM EMPLOYEE;

-- 19. Display the following for each employee <E-Name> earns <Salary> monthly but wants <3*Current Salary>. Label the Column as Dream Salary.
SELECT Ename, Salary, CONCAT(Ename, ' earns ', Salary, ' monthly but wants ', 3 * Salary) AS Dream_Salary FROM EMPLOYEE;

-- 20. Display Name with the 1st letter capitalized and all other letters lower case and length of their name of all the employees whose name starts with ‘J’, ‘A’ and ‘M’.
SELECT CONCAT(UCASE(LEFT(Ename, 1)), LCASE(SUBSTRING(Ename, 2))) AS Proper_Name, LENGTH(Ename) AS Name_Length 
FROM EMPLOYEE 
WHERE Ename LIKE 'J%' OR Ename LIKE 'A%' OR Ename LIKE 'M%';

-- 21. Display Name, Hire Date and Day of the week on which the employee started.
SELECT Ename, Hire_date, DAYNAME(Hire_date) AS Start_Day FROM EMPLOYEE;

-- 22. Display Name, Department Name and Department No for all the employees.
SELECT Ename, DEPARTMENT.Dname, EMPLOYEE.Dno 
FROM EMPLOYEE 
JOIN DEPARTMENT ON EMPLOYEE.Dno = DEPARTMENT.Dno;

-- 23. Display Unique Listing of all Jobs that are in Department #30.
SELECT DISTINCT Job_type 
FROM EMPLOYEE 
WHERE Dno = 30;

-- 24. Display Name, Department Name of all employees who have an ‘A’ in their name.
SELECT Ename, Dname 
FROM EMPLOYEE 
JOIN DEPARTMENT ON EMPLOYEE.Dno = DEPARTMENT.Dno 
WHERE Ename LIKE '%A%';

-- 25. Display Name, Job, Department No. and Department Name for all the employees working at the Dallas location.
SELECT Ename, Job_type, EMPLOYEE.Dno, Dname 
FROM EMPLOYEE 
JOIN DEPARTMENT ON EMPLOYEE.Dno = DEPARTMENT.Dno 
WHERE Location = 'Dallas';

-- 26. Display Name and Employee no. Along with their Manager’s Name and the Manager’s employee no; along with the Employees Name who do not have a Manager.
SELECT E1.Ename AS Employee_Name, E1.Eno AS Employee_No,
       E2.Ename AS Manager_Name, E2.Eno AS Manager_No
FROM EMPLOYEE E1
LEFT JOIN EMPLOYEE E2 ON E1.Manager = E2.Eno;

-- 27. Display Name, Department No. And Salary of any employee whose department no. and salary matches both the department no. and the salary of any employee who earns a commission.
SELECT Ename, Dno, Salary 
FROM EMPLOYEE 
WHERE (Dno, Salary) IN (
    SELECT Dno, Salary 
    FROM EMPLOYEE 
    WHERE Commission IS NOT NULL
);
